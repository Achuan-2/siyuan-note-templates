{{//!js_esc_newline_const query = async (maxLevel = 2) =&gt; { // 设置maxLevel参数，展示到x级标题_esc_newline_    let dv = Query.DataView(protyle, item, top);_esc_newline_    let ans = await Query.request('/api/outline/getDocOutline', {_esc_newline_        id: "20250906144337-g9hxy21" //修改笔记id，动态获取当前文档ID，使用Query.root_id(protyle)_esc_newline_    });_esc_newline_    ans = Query.wrapit(ans);_esc_newline_    _esc_newline_    // 递归处理标题，增加层级判断，超过maxLevel则停止_esc_newline_    const iterate = (data, currentLevel = 1) =&gt; {_esc_newline_        for (let item of data) {_esc_newline_            // 仅当前层级小于maxLevel时，才继续处理子标题_esc_newline_            if (item.count &gt; 0 &amp;&amp; currentLevel &lt; maxLevel) {_esc_newline_                let subtocs = iterate(item.blocks ?? item.children, currentLevel + 1);_esc_newline_                item.children = Query.wrapBlocks(subtocs);_esc_newline_            } else {_esc_newline_                // 超过目标层级，清空子标题（避免显示深层级）_esc_newline_                delete item.children;_esc_newline_                delete item.blocks;_esc_newline_            }_esc_newline_        }_esc_newline_        return data;_esc_newline_    }_esc_newline_    _esc_newline_    let tocs = iterate(ans);_esc_newline_    dv.addlist(tocs, {_esc_newline_	    renderer: b =&gt; `[${b.name || b.content}](${b.asurl})`,_esc_newline_    });_esc_newline_    dv.render();_esc_newline_}_esc_newline__esc_newline__esc_newline_return query(); _esc_newline_}}
{: id="20250906144337-rxv5b9t"}

{: id="20250906145107-ner90pp"}

{: id="20250906144337-g9hxy21" title="思源笔记模板丨动态显示标题层级" type="doc"}