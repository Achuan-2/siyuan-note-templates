‸<!------------------模板变量-------------------------->
Title:.action{.title}

<!-- 这个返回的是一个block列表 ，"$blocks :="变量语法-->

.action{$blocks :=sql "SELECT * FROM blocks WHERE path LIKE '%/.title.sy' AND markdown LIKE '%**%**%' AND type like'%p%'"}

<!-- 模板sql查询循环语法 -->
.action{range $b := $blocks}
.action{$b}
.action{$b.ID} | .action{$b.Path} 
Type: .action{$b.Type}
Markdown: .action{$b.Markdown} 
Content: .action{$b.Content} 
.action{end}
<!-- 循环结束 -->


<!-------------------模板日期相关-------------------------->

‸<!-- 返回今天日期和星期 英文 -->
‸
.action{ now | date "2006-01-02  Mon "}

<!-- 返回今天日期和星期 中文 -->
.action{$ini_date := toDate "2006-01-02" "2021-05-02"}
.action{$now_date := now}
.action{$subdays := mod (div ($now_date.Sub $ini_date).Hours 24) 7}
.action{$today := last (slice (list "星期一" "星期二" "星期三" "星期四" "星期五" "星期六" " 星期日") 0 $subdays)}
.action{now | date "2006-01-02"} .action{$today}



<!-- 返回今天过去几天,date_modify好像只能接收小时吗-->
.action{(now | date_modify "-72h")| date "20060102"}

<!-- 返回这一周的日期范围-->
.action{$ini_date := toDate "2006-01-02" "2021-05-02"}
.action{$now_date := now}
.action{$day := mod (div ($now_date.Sub $ini_date).Hours 24) 7}
.action{$leftday :=mul (sub $day 1)  24}
.action{$rightday :=mul (sub 7 $day) 24}
.action{$leftHour :=nospace (cat "-" $leftday "h") }
.action{$rightHour :=nospace (cat "+" $rightday "h")}

.action{(now | date_modify $leftHour) | date "2006-01-02"} ~ .action{(now | date_modify $rightHour) | date "2006-01-02"}




<!------------------模板嵌入-------------------------->
<!-- 模板块嵌入例子1：本文档加粗文字汇总（D大说这里会加一个sql函数，直接查询加粗-->
本文档加粗文字汇总
{{SELECT * FROM blocks WHERE path LIKE '%/.action{.title}.sy' AND markdown LIKE '%**%**%' AND type ='p'}}
<!-- END -->

<!-- 模板块嵌入例子2：查询今天更新的所有笔记，root_id != '.action{.id}'排除了查询页面的内容 -->
.action{$week := add (mod (div ((toDate "2006-01-02" "2050-03-13").Sub now).Hours 24) 7) 1}
## .action{now | date "2006-01-02"} .action{last (slice (list "星期六" "星期五" "星期四" "星期三" "星期二" "星期一" " 星期天") 0 $week )} 笔记汇总

{{SELECT * FROM blocks WHERE updated > ".action{now | date "20060102"}" AND type !='d' AND root_id != '.action{.id}' order by created }}
<!-- END -->

<!-- 模板块嵌入例子3：查询近3天更新的所有笔记，date_modify "-72h" 是调用函数=当前时间-h -->
## .action{(now | date_modify "-72h")| date "20060102"} -  .action{now | date "2006-01-02"} 创建笔记汇总

{{SELECT * FROM blocks WHERE updated > ".action{(now | date_modify "-72h") | date "20060102"}" AND type !='d' AND root_id != '.action{.id}' order by created }}
<!--END-->